## ------------------------------------------------------------------------
(pt = st_point(c(0,1)))
attributes(pt)


## ------------------------------------------------------------------------
system.file("shape/storms_xyz_feature.shp", package="sf") %>%
	st_read()
system.file("shape/storms_xyzm_feature.shp", package="sf") %>% # badly named!
	st_read()
(pzm = st_point(c(1,2,3,4)))


## ------------------------------------------------------------------------
(m1 = rbind(c(8, 1), c(2, 5), c(3, 2)))
(mp = st_multipoint(m1))
(ls = st_linestring(m1))


## ------------------------------------------------------------------------
st_dimension(mp)
st_dimension(ls)


## ------------------------------------------------------------------------
m2 = rbind(c(22,20), c(18, 15))
(mls = st_multilinestring(list(m1, m2)))


## ------------------------------------------------------------------------
(ring1 = rbind(c(0,0), c(4,0), c(4,4), c(0,4), c(0,0)))
(p1 = st_polygon(list(ring1)))
(ring2 = ring1 + 5)
(ring3 = (ring1[5:1,] / 4) + 6)
(p2 = st_polygon(list(ring2, ring3)))


## ------------------------------------------------------------------------
(mpol = st_multipolygon(list(list(ring1), list(ring2, ring3))))


## ------------------------------------------------------------------------
st_geometrycollection(list(pt, mp, ls, mpol))


## ------------------------------------------------------------------------
st_point(c(1/3, 2/3))
print(st_point(c(1/3, 2/3)), digits = 16)
print(st_point(c(1/3, 2/3)), digits = 3)


## ------------------------------------------------------------------------
(wkb = st_as_binary(st_point(c(1/3, 2/3))))
st_as_sfc(wkb)[[1]]


## ------------------------------------------------------------------------
st_is_simple(st_linestring(rbind(c(0,0), c(1,1), c(1,0), c(0,1)))) # self-intersects
st_is_valid(st_polygon(list(rbind(c(1,1), c(0,0), c(1,1), c(2,2), c(2,1), c(1,1))))) # repeats


## ------------------------------------------------------------------------
(e = st_intersection(st_point(c(0,0)), st_point(c(1,1))))


## ------------------------------------------------------------------------
st_is_empty(e)


## ------------------------------------------------------------------------
methods(st_cast)


## ------------------------------------------------------------------------
(ls <- st_as_sfc("CIRCULARSTRING(0 0,1 0,1 1)") %>% st_cast("LINESTRING"))
plot(ls, axes = TRUE)


## ------------------------------------------------------------------------
rbind(c(0,0), c(1,1), c(1,0), c(0,1)) %>% st_linestring() %>% st_cast("POINT")


## ------------------------------------------------------------------------
rbind(c(0,0), c(1,1), c(1,0), c(0,1)) %>% st_linestring() %>% st_cast("POINT")


## ------------------------------------------------------------------------
(p <- rbind(c(0,0), c(1,1), c(1,0), c(0,1)) %>% st_linestring() %>% st_sfc() %>% st_cast("POINT"))


## ------------------------------------------------------------------------
pt <- st_point(c(1, 0))
ls <- st_linestring(matrix(c(4, 3, 0, 0), ncol = 2))
poly1 <- st_polygon(list(matrix(c(5.5, 7, 7, 6, 5.5, 0, 0, -0.5, -0.5, 0), ncol = 2)))
poly2 <- st_polygon(list(matrix(c(6.6, 8, 8, 7, 6.6, 1, 1, 1.5, 1.5, 1), ncol = 2)))
multipoly <- st_multipolygon(list(poly1, poly2))

j <- st_geometrycollection(list(pt, ls, poly1, poly2, multipoly))

st_collection_extract(j, "POLYGON")
st_collection_extract(j, "POINT")
st_collection_extract(j, "LINESTRING")


## ------------------------------------------------------------------------
(sfc = st_sfc(st_point(c(0,1)), st_point(c(-3,2)), crs = 4326))


## ------------------------------------------------------------------------
class(sfc)


## ------------------------------------------------------------------------
attributes(sfc) %>% names() %>% setdiff("class")


## ------------------------------------------------------------------------
(p <- rbind(c(0,0), c(1,1), c(1,0), c(0,1)) %>% st_linestring() %>% st_sfc() %>% st_cast("POINT"))


## ------------------------------------------------------------------------
length(p)


## ------------------------------------------------------------------------
p %>% st_combine
p %>% st_combine %>% st_cast("LINESTRING")


## ------------------------------------------------------------------------
p[[2]]


## ------------------------------------------------------------------------
(g = st_sfc(st_point(c(0,0)), st_linestring(rbind(c(0,0), c(1,1)))))


## ------------------------------------------------------------------------
g %>% st_is("LINESTRING")


## ------------------------------------------------------------------------
st_sf(g) %>% filter(st_is(., "LINESTRING"))


## ------------------------------------------------------------------------
sf = st_sf(sfc)
class(sf)


## ------------------------------------------------------------------------
sf %>% attributes() %>% names() %>% setdiff(c("row.names", "class", "names"))


## ------------------------------------------------------------------------
pts = rbind(c(-179,0), c(179,0), c(179,1), c(-179,1), c(-179,0))
date_line = st_sfc(st_polygon(list(pts)), crs = 4326)
st_bbox(date_line) %>% st_as_sfc()


## ------------------------------------------------------------------------
pts = rbind(c(0,89), c(120,89), c(240,89), c(0,89))
pole = st_sfc(st_polygon(list(pts)), crs = 4326)
st_bbox(pole) %>% st_as_sfc()


## ------------------------------------------------------------------------
st_is_valid(st_polygon(list(rbind(c(0,0), c(0,1), c(1,1), c(0,0)))))

